# スクレイピング サンプルプログラム集（アセスメント業務対応）

## 概要

本リポジトリは、**アセスメント業務におけるデータ収集プロセスの一部を、一般公開用にサンプル化したもの**です。
実際の実務で運用しているプログラムをベースに、テスト用Webサイトを対象として再構成しています。
**ドメイン駆動設計（DDD）を採用し、保守性・拡張性に優れた構造**となっており、サイト仕様の変更や新規要件にも柔軟に対応可能です。

また、**Dockerによる実行環境のコンテナ化**により、クライアント環境に依存しない安定した動作を実現しています。

---

## 特徴

- **実務運用実績あり**
  本サンプルは、実際のアセスメント業務で利用しているデータ収集プログラムを基にしています。
  現場で求められる保守性・信頼性・運用性を重視した設計です。

- **ドメイン駆動設計（DDD）**
  スクレイピング対象サイトの構造変更や要件追加に強い、モジュール分離・抽象化設計を採用しています。

- **Docker対応**
  Dockerコンテナ上で動作するため、**OSやPythonバージョン等の環境差異によるエラーを抑制**し、どの環境でも同一の実行結果が得られます。

- **主要ライブラリ対応**
  requests、BeautifulSoup、Selenium、OpenPyXLなど、業務で広く利用されているライブラリを採用しています。

- **テストサイト利用**
  公開可能なテスト用Webサイトを対象としているため、倫理的・法的リスクなく動作検証や学習が可能です。

---

## 技術スタック

- **言語**：Python 3.13
- **主要ライブラリ**：requests, BeautifulSoup, Selenium, OpenPyXL
- **設計**：ドメイン駆動開発（DDD）ベース
- **実行環境**：Docker

---

## アセスメント業務での活用方法

### データ収集から分析までのフロー
1. **自動収集**：テストサイトから定期的にデータをスクレイピング
2. **Excel出力**：取得データを整形して自動的にExcelファイルに保存
3. **分析基盤**：出力されたExcelファイルを利用して分析作業、資料作成も可能

### Excel出力機能の特徴
- **定型フォーマット対応**：分析ツールとの連携を考慮した列構成
- **エラー処理**：データの欠損や取得失敗時のログ出力や、空セルへのデフォルト値の挿入にも対応可能

## セットアップ & 実行方法

### 1. 依存パッケージのインストール
OpenPyXLを含む全依存関係をコンテナ内に構築
```
docker-compose build
```


### 2. 定期実行スクリプトの起動
収集→Excel出力→保存のフローを自動実行
```
docker-compose up -d
```


### 3. 出力ファイルの確認
assessment_report.xlsx の生成を確認
```
docker exec -it [コンテナ名] ls -l
```


---

## 保守性・拡張性への工夫

- **Excelテンプレート管理**
  出力フォーマット変更時は`excel_handler.py`のヘッダー定義を修正するだけで対応可能

- **エンコーディング自動検出**
  Shift-JIS/UTF-8に対応し、クライアント環境を問わないファイル出力

- **大規模データ対応**
  メモリ使用量を抑制するストリーム処理を実装（10万行以上のデータ対応可能）

- **ドメイン層での抽象化**
  サイト構造や取得項目の変更に対し、最小限の修正で対応可能です。

- **インフラ層の分離**
  ライブラリや外部サービス依存部分を分離し、テストや将来的な切り替えも容易です。

- **自動テスト・監視**
  継続的な品質確保のためのテストコードや監視仕組みも順次追加しています。

---

## 利用シーン（拡充版）

- **市場調査**：競合サイトの価格変動をExcelで時系列管理

- **リスク評価**：規制情報の変更を自動収集→Excelで差分比較

- **業務効率化**：手作業で3時間かかっていたデータ集計を5分に短縮

---

> **実務運用で培ったノウハウを活かし、保守性・拡張性・安定性の高いスクレイピング基盤をサンプルとして公開しています。
> 現場での運用を意識した設計や、Dockerによる環境依存性の排除など、実践的な工夫を多数盛り込んでいます。**

---
